import os
import psycopg2

def insereArq(nome, virus):
	listArq = os.listdir(nome)
	numArq = len(listArq)

	arq = 'arq'

	for i in range(int(numArq/10)):
		sql = "insert into arquivos values("

		path = nome + arq + str(i) + '.txt'
		
		with open(path,'r') as f:
			auxBin = f.read()

		sql += "default, '" + auxBin + "', " + virus + ")"

		cur.execute(sql)
		con.commit()

senha = input('Entre com a senha do banco: ')

#Faz conex√£o com o bd
con = psycopg2.connect(host='localhost', database='deeplearning', user='postgres', password=senha, port='5433')
cur = con.cursor()

#Cria uma tabela para colocar os arquivos
sql = "create table arquivos (id serial primary key, binario varchar(1000000), evirus bool)"
cur.execute(sql)

#Insere no banco de dados
insereArq('benign/', 'false')
insereArq('malicious/', 'true')

con.close()
